마켓컬리 장바구니 데이터베이스  분석 & 기획 & 설계

관리자(MyAdmin) 

http://gksmf519.dothome.co.kr/myadmin
gksmf519
ming0303!

[1] 프론트앤드
    * 리덕스 스토어 장바구니(카트) 저장되어 있다.
    할일(프로젝트)
    1. 로그인 하기전 장바구니 목록 있는경우
    2. 로그인하면 기존 장바구니 목록을 로그인 장바구니 목록에 추가한다.

    구현 => 로그인 상태 => 데이터베이스에 장바구니 저장
    이전에 로그인 안한상태에서의 장바구니는 완벽하게 마루가 된상태 이다.
    그러므로 이젠 로그인 상태로 구현한다.
    로그인한 상태는 모든 장바구니가 데이터베이스에 저장 관리된다.
    로그인하면 어디든지 장소에 관계없이 장바구니를 
    CRUD를 구현할 수 있다.


    // 프로그래밍은 
    // 최상위 컴포넌트에서 작업한다.

    장바구니에 데이터가 있다고 간주한 상태로 시작합니다.

    1. 임시 상태변수 cart  setCart
    2. cart에 리덕스 스토어에 있는 장바구니 목록 모두가져와서 저장한다.
    3. cart에 있는 장바구니 목록을 모두(맵함수) 데이터베이스에 저장한다.
       한번에 한목록(항목)씩 데이터베이스에 저장한다.
    4. 저장완료 했는데 새로고침하면 또 저장된다. 그래서
       cart 상태변수에 장바구니 목록을 모두 삭제한다.'
    5. 그리고 데이터베이스에 장바구니를 저장한걸 표시해야한다. 
       cartDbSave ok! 표시 => 로컬 저장소에 저장해둔다.
    6. 조건문에  cartDbSave ok 문자 있다면 저장 더이상 안한다.


    2단계
    백앤드 조건문 수행
    데이터베이스에 장바구니에 중복된 상품 저장시
    update 수량만 증가시킨다.(수정)
    
    데이터베이스에 장바구니에 중복안된 상품 저장시
    insert 문으로 저장 추가한다.

    2-1. 사용자아이디, 제품코드 =>  중복체크 => SELECT 문
    2-2. 데이터가 존재한다면 중복됨
    2-3. if() 문 사용
    2-4. 중복되면 수량만 수정(UPDATE)
    2-5. 중복안되면 데이터 추가(INSERT) 저장
    2-6. 저장 완료 후 가져오기 해야 한다. => 데이터베이스 장바구니 데이터목록 가져오기(조회 SELECT)

    3단계 수량 수정
    단일상품
    중복상품

    1. 조건1 DB 연동 => 로그인 되었다면 연동
    2. 조건2 수량을 => 데이터베이스에 넘겨준다. => PHP => MYSQL(UPDATE 사용자아이디, 제품코드 기준으로, 수량=수량+$수량) => DB 저장 => 응답
    3. 백앤드 파일 => green_kurly_cart_table_update.php(사용자아이디, 제품코드) => 성공: 1, 실패: 0
    4. 백앤드 파일 => green_kurly_cart_table_select.php (사용자아이디, 제품코드) => json 파일

    
    4단계
    개별 체크 삭제
    선택 체크 삭제


```
[{"번호":"INTRO_S02_003","이미지":"./images/intro/section2/1647496856931l0.jpg","제품명":"[선물세트] 경주천년한우 1++ 특수부위 세트 (냉장) (예약일 수령)","할인율":"0.45","판매가":"8250","제품특징":"","제조사":"","제조일시":"2023-03-03 19:30:00","판매처":"Kurly Only","보관방법":"냉장","배송":"새벽배송","옵션":"다중상품","옵션상품목록":"[{\"상품명\":\"달콤한 딸기 3kg\",\"정가\":25000},{\"상품명\":\"사랑스런 체리 1kg\",\"정가\":15000}]","정가":"15000","일시":"1704416298995","제품코드":"INTRO_S02_003, 사랑스런 체리 1kg","장바구니상품명":"사랑스런 체리 1kg","수량":"1"},{"번호":"INTRO_S02_003","이미지":"./images/intro/section2/1647496856931l0.jpg","제품명":"[선물세트] 경주천년한우 1++ 특수부위 세트 (냉장) (예약일 수령)","할인율":"0.45","판매가":"8250","제품특징":"","제조사":"","제조일시":"2023-03-03 19:30:00","판매처":"Kurly Only","보관방법":"냉장","배송":"새벽배송","옵션":"다중상품","옵션상품목록":"[{\"상품명\":\"달콤한 딸기 3kg\",\"정가\":25000},{\"상품명\":\"사랑스런 체리 1kg\",\"정가\":15000}]","정가":"15000","일시":"1704416298995","제품코드":"INTRO_S02_003, 달콤한 딸기 3kg","장바구니상품명":"달콤한 딸기 3kg","수량":"1"},{"번호":"INTRO_S02_002","이미지":"./images/intro/section2/1647483683658l0.jpg","제품명":"[선물세트] 경주천년한우 1++ 특수부위 세트 (냉장) (예약일 수령)","할인율":"0.15","판매가":"66300","제품특징":"","제조사":"","제조일시":"2023-05-03 18:30:00","판매처":"Kurly Only","보관방법":"냉장","배송":"새벽배송","옵션":"단일상품","옵션상품목록":"[]","정가":"78000","일시":"1704416396250","제품코드":"INTRO_S02_002","장바구니상품명":"[선물세트] 경주천년한우 1++ 특수부위 세트 (냉장) (예약일 수령)","수량":"4"}]
    
```
    
    
[2] 백앤드 : 
    
    - 테스트 URL
    http://gksmf519.dothome.co.kr/kurly_green/green_kurly_cart_table.php

   


[3] 데이터베이스
    - 장바구니(카트) 테이블 이름 : green_kurly_cart_table
장바구니 소속(누구?) => 회원 로그인시 아이디

```SQL
CREATE TABLE green_kurly_cart_table (
    `idx`   INT  NOT NULL  AUTO_INCREMENT  COMMENT '장바구니 고유번호 기본키 PK',
    `userId`  VARCHAR(16)  NOT NULL  COMMENT '회원아이디 외래키 FK 회원테이블 참조',
    `번호`   VARCHAR(30)  NOT NULL  COMMENT '상품 번호',
    `이미지`  VARCHAR(250) NOT NULL  COMMENT '상품 이미지',
    `제품명`  VARCHAR(100) NOT NULL  COMMENT '제품명',
    `할인율`  DOUBLE   NOT NULL  COMMENT '할인율',
    `판매가`  INT  COMMENT '판매가',
    `제품특징`  VARCHAR(100) COMMENT '제품특징',
    `제조사`   VARCHAR(50) COMMENT '제조사',
    `제조일시`  VARCHAR(30) COMMENT '제조일시',
    `판매처`   VARCHAR(50) COMMENT '판매처',
    `보관방법`  VARCHAR(20) NOT NULL COMMENT '보관방법',
    `배송`  VARCHAR(20)   COMMENT '판매처',
    `옵션`  VARCHAR(20)   COMMENT '옵션',
    `옵션상품목록` VARCHAR(250)  COMMENT '제품특징',
    `정가` INT  NOT NULL  COMMENT '정가',
    `일시`  VARCHAR(30) COMMENT '일시',
    `제품코드`  VARCHAR(250)  NOT NULL COMMENT '제품코드 번호+옵션상품명',
    `장바구니상품명`  VARCHAR(250) COMMENT '옵션목록 상품명',
    `수량`  INT  NOT NULL COMMENT '수량',
    `등록일`   TIMESTAMP  DEFAULT CURRENT_TIMESTAMP  NOT NULL COMMENT '등록일',
    PRIMARY KEY(`idx`),    
    FOREIGN KEY(`userId`)  REFERENCES  green_kurly_table(`userId`)

) ENGINE=MyISAM DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci  COMMENT '장바구니 고유번호 기본키 PK';

```

idx,userId,번호,이미지,제품명,할인율,판매가,제품특징,제조사,제조일시,판매처,보관방법,배송,옵션,옵션상품목록,정가,일시,제품코드,장바구니상품명,수량,등록일


'$idx','$userId','$번호','$이미지','$제품명','$할인율','$판매가','$제품특징','$제조사','$제조일시','$판매처','$보관방법','$배송','$옵션','$옵션상품목록','$정가','$일시','$제품코드','$장바구니상품명','$수량','$등록일',



$userId
$번호
$이미지
$제품명
$할인율
$판매가
$제품특징
$제조사
$제조일시
$판매처
$보관방법
$배송
$옵션
$옵션상품목록
$정가
$일시
$제품코드
$장바구니상품명
$수량




    - 주문(결제) 테이블 이름 : green_kurly_order_table
   
    http://gksmf519.dothome.co.kr/kurly_green/green_kurly_cart_table.php

    ```MYSQL      
        
    $SQL = "CREATE TABLE green_kurly_cart_table (
        cartId                  INT  NOT NULL  AUTO_INCREMENT,
        cartPrductId            VARCHAR(50)       NOT NULL,
        cartPrductName          VARCHAR(250)      NOT NULL,
        cartPrductCount         INT               NOT NULL,
        cartPrductPrice         INT               NOT NULL,
        cartPrductDate          VARCHAR(30)       NOT NULL,
        cartPrductDiscountRate  DOUBLE            NOT NULL,
        cartPrductStore         VARCHAR(20)       NOT NULL,        
        cartPrductUrl           VARCHAR(250)      NOT NULL,        
        cartOrderPrice          INT               NOT NULL,
        cartOrderDiscount       INT               NULL,
        cartOrderDelivery       INT               NULL,
        cartOrderSum_payment    INT              NOT NULL,
        cartOrderDate           TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
        PRIMARY KEY(cartId)
    ) ENGINE=MyISAM DEFAULT CHARSET=utf8mb4";


    ```
    장바구니 데이터 저장
    green_kurly_cart_insert_table
    
    http://gksmf519.dothome.co.kr/kurly_green/green_kurly_cart_table_insert.php



[4] REST API 
    










