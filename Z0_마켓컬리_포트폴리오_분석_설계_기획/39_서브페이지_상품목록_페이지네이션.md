서브페이지_상품목록_페이지네이션.txt

관리자(MyAdmin) 상품 데이터_서브페이지_상품목록_페이지네이션  & 분석 & 기획 & 설계

http://gksmf519.dothome.co.kr/myadmin
gksmf519
anstjswhd0105#


[1] 프론트앤드
    * 컴포넌트 구성
    - ProductList.jsx
    - 페이지네이션 알고리즘 
      * 전체 상품 목록의 개수 / 한화면에 보여줄 개수 => 결과에 자리올림
      예]
      77 / 12 = 6.416666667 => 7 (총 페이지수)

      1페이지 => 1 ~ 12
      2페이지 => 13 ~ 12
      3페이지 => 
      4페이지 => 
      5페이지 => 
      6페이지 => 
      7페이지 => 

예1] 77	한화면에 목록개수(pageList)	12		6.416666667	7	페이지
예2] 77	자리올림 목록개수(pageList)	9		8.555555556	24	페이지

	pageNum[1,2,3,4,5,6,7]	    				
    page = 1
	1페이지	1	12	/ 12(pageList) =>  자리올림 => 1		
	2페이지	13	24	/ 12(pageList) =>  자리올림 => 2 		
	3페이지	25	36	/ 12(pageList) =>  자리올림 => 3 			
	4페이지	37	48	/ 12(pageList) =>  자리올림 => 4 			
	5페이지	49	60	/ 12(pageList) =>  자리올림 => 5 			
	6페이지	61	72	/ 12(pageList) =>  자리올림 => 6 			
	7페이지	73	84	/ 12(pageList) =>  자리올림 => 7 			

```js

 const [state, setState] = React.useState({
        // 1. 페이지네이션 상품목록 
        pageList: 9,  // 한화면에 보여줄 개수 => 반드시 자리올림(Math.ceil) 반영
        page: 1,      // 1페이지(첫페이지) => 페이지번호를 => 페이지 버튼 클릭해서 구현
        totalPage: 0, // 총페이지수 26 = Math.ceil(상품목록총개수(77)/한화면보여줄개수(3))
        pageNum: [],   // 페이지번호 저장 배열 []

        // 2. 페이지네이션 버튼번호 목록 1 ~ 26 => 게시판
        pageListBtn: 5, // 한화면에 표시할 버튼 페이지 개수
        pageBtn: 1,     // 버튼 그릅의 첫페이지 1=> [1,2,3,4,5]  2=> [6,7,8,910]
        totalPageBtn: 0,// 총버튼페이지수 6 = Math.ceil(Math.ceil(77/3)/5) => Math.ceil(26/5)
        pageNumBtn: [], // 페이지버튼번호 저장 배열 [] 
        // 1 버튼페이지 => [ 1, 2, 3, 4, 5]  
        // 2 버튼페이지 => [ 6, 7, 8, 9,10]
        // 3 버튼페이지 => [11,12,13,14,15]
        // 4 버튼페이지 => [16,17,18,19,20]
        // 5 버튼페이지 => [21,22,23,24,25]
        // 6 버튼페이지 => [26]


        is추천순: false,
        is신상품순: true,
        is판매량순: false,
        is혜택순: false,
        is낮은가격순: false,
        is높은가격순: false  
    });

    const navigate = useNavigate();
    const dispatch = useDispatch();
    const selector = useSelector((state)=>state);


    // 전체 페이지 설정하기
    // 자리올림 Math.ceil()
    // 자리내림 Math.floor()
    // 자리반올림 Math.round()
    React.useEffect(()=>{
        if(상품.length>0){
            setState({
                ...state,
                totalPage: Math.ceil(상품.length/state.pageList),
                totalPageBtn: Math.ceil(Math.ceil(상품.length/state.pageList)/state.pageListBtn)
            })
        }
    }, [상품]);

    // 페이지번호 저장 배열
    // 1. 총버튼 페이지수 계산 구현
    // 2. 페이지 버튼 번호 배열[]에 저장 구현
        // 1 버튼페이지 => [1,2,3,4,5]  
        // 2 버튼페이지 => [6,7,8,9,10]
        // 3 버튼페이지 => [11,12,13,14,15]
        // 4 버튼페이지 => [16,17,18,19,20]
        // 5 버튼페이지 => [21,22,23,24,25]
        // 6 버튼페이지 => [26 .........30]
    React.useEffect(()=>{

        const {totalPage, pageBtn, pageListBtn} = state;

            if( totalPage > 0 ){
                
                // 페이지네이션 버튼 그룹
                let frontNum = 0;     // 시작번호(앞번호)
                let rearNum = 0;      // 끝  번호(뒷번호)
                let pageNumBtn = [];  // pageNum[1,2,3,4,5]
                
                // 알고리즘
                frontNum = (((pageBtn-1) * pageListBtn) + 1); // 1   6  11  16  21  26 = 6-1 * 5 + 1
                rearNum  = frontNum + pageListBtn - 1;        // 5  10  15  20  25  30           
                for(let i=frontNum; i<=rearNum; i++){
                    pageNumBtn = [...pageNumBtn, i];
                }
        
                setState({
                    ...state,
                    pageNumBtn: pageNumBtn
                })
            }

    }, [state.totalPage]);


    // 버튼 다음페이지 그룹 클릭 이벤트
    const onClickNextBtnPage=(e)=>{
        e.preventDefault();        
        
        let frontNum = 0;     // 시작번호(앞번호)
        let rearNum = 0;      // 끝  번호(뒷번호)
        let pageNumBtn = [];  // pageNum[1,2,3,4,5]
        let pageBtn = state.pageBtn;  // 현재 버튼 그룹 번호 가져오기  1
        
        // 알고리즘
        pageBtn += 1;  // 카운트 페이지버튼 그룹 1씩 증가 1 2 3 4 5 6
        frontNum = (((pageBtn-1) * state.pageListBtn) + 1);
        rearNum  = frontNum + state.pageListBtn - 1;
        
        // 끝번호 구현
        // 끝번호 페이지번호가 총페이지번호보다 크면 
        // 그러면 => 끝번호를 총페이지번호로 설정한다.
        if(rearNum > state.totalPage ){
            rearNum = state.totalPage;
        }

        for(let i=frontNum; i<=rearNum; i++){
            pageNumBtn = [...pageNumBtn, i];
        }

        setState({
            ...state,
            pageBtn: pageBtn,
            pageNumBtn: pageNumBtn
        })
    }


    // 버튼 이전페이지 그룹 클릭 이벤트
    const onClickPrevBtnPage=(e)=>{
        e.preventDefault();
        let frontNum = 0;     // 시작번호(앞번호)
        let rearNum = 0;      // 끝  번호(뒷번호)
        let pageNumBtn = [];  // pageNum[1,2,3,4,5]
        let pageBtn = state.pageBtn;  // 현재 버튼 그룹 번호 가져오기  1
        
        // 알고리즘
        pageBtn -= 1;  // 카운트 페이지버튼 그룹 1씩 증가
        frontNum = (((pageBtn-1) * state.pageListBtn) + 1);
        rearNum  = frontNum + state.pageListBtn - 1;
        for(let i=frontNum; i<=rearNum; i++){
            pageNumBtn = [...pageNumBtn, i];
        }

        setState({
            ...state,
            pageBtn: pageBtn,
            pageNumBtn: pageNumBtn
        })
    }

    
  



    // 페이지 번호 클릭 이벤트 => 페이지 구현
    const onClickPage=(e, num)=>{
        e.preventDefault();
        setState({
            ...state,
            page: num
        })
    }

    // 첫페이지 클릭 이벤트
    const onClickFirstPage=(e)=>{
        e.preventDefault();
        setState({
            ...state,
            page: 1
        })
    }

    // 마지막 페이지 클릭 이벤트
    const onClickLastPage=(e)=>{
        e.preventDefault();
        setState({
            ...state,
            page: state.totalPage // 전체페이지가 마지막페이지 숫자
        })
    }

    // 이전 페이지 클릭 이벤트
    const onClickPrevPage=(e)=>{
        e.preventDefault();
        let page = state.page;  // 현재 상태 페이지 가져오기
        if(page<=1){
            page = 1;
        }
        else{
            page -= 1;
        }
        setState({
            ...state,
            page: page
        })
    }

    // 다음 페이지 클릭 이벤트
    const onClickNextPage=(e)=>{
        e.preventDefault();
        let page = state.page;   // 현재 상태 페이지 가져오기
        if(page>=state.totalPage){  // 총페이지수 보다 크면
            page = state.totalPage; // 마지막페이지로 지정
        }
        else{
            page += 1;
        }
        setState({
            ...state,
            page: page
        })
    }



<ul>
                    {
                        상품.length > 0 && (
                            상품.map((item, idx)=>{ // 0 ~ 76 => idx+1 => 1 ~ 77

                                // 페이지네이션 구현 기본 => 1페이지 시작
                                // console.log( idx )
                                    // 페이지 1 ~ 7
                                    // 1  === 1
                                if( Math.ceil((idx+1)/state.pageList) === state.page  ){
                                    let 옵션최소정가 = 0;
                                    let 최소정가;

                                    if(item.옵션==='다중상품'){
                                        옵션최소정가 = 100000000; // 각 행마다 최소값 초기화
                                        item.정가.map((item2, idx2)=>{                
                                            if(옵션최소정가 > item2.정가){
                                                옵션최소정가 = item2.정가;
                                            }                    
                                        });
                                        최소정가=옵션최소정가;
                                    }
                                    else{                
                                        최소정가=item.정가;
                                    }

                                    return(
                                        <li className={`list list${idx+1}`} key={item.번호}>
                                            
                                            <div className="col-gap"  onClick={(e)=>onClickViewProduct(e, item, 최소정가, item.정가, './images/sub/')}>
                                                <div className="img-box">
                                                <a href="!#"><img src={`./images/sub/sub1/${item.이미지}`} alt="" /></a>
                                                </div>
                                                <div className="txt-box">                                        
                                                    <p><a href="!#"><img src="./images/intro/section2/icon_cart.svg" alt="" /> 담기</a></p>
                                                    <h6>{item.배송}</h6>
                                                    <h3>{item.제품명}</h3>
                                                    <h6>{item.제품특징}</h6>
                                                    {
                                                        item.할인율!==0 && <h4>{Number(최소정가).toLocaleString('ko-KR')}원</h4>
                                                    }
                                                    <h5>
                                                    {
                                                        item.할인율!==0 && <em>{Math.round(item.할인율*100)}%</em>
                                                    }
                                                        <strong className={item.할인율===0?'on':''}>{Math.round(Number(최소정가)*(1-item.할인율)).toLocaleString('ko-KR')} {item.옵션==="단일상품" ? "원":"원~"}</strong></h5>
                                                        
                                                    <h6><img src="./images/intro/section2/icon_count.svg" alt="" />{item.리뷰}</h6>                                                
                                                    <h6>{item.유형}</h6>
                                                    <h6>{item.무료배송}</h6>
                                                </div>

                                            </div>
                                        </li>
                                    )
                                }
                                // 페이지네이션 구현 기본 => 1페이지 끝

                            })
                        )
                    }
                </ul>

                <div id="pagenation">
                    <div className="pagenation-box">
                        <ul>
                            {
                                state.pageBtn > 1 && (
                                <>
                                <li><button onClick={onClickFirstPage}><img src="./images/pagenation/icon_first.png" alt="" /></button></li>    
                                <li><button onClick={onClickPrevPage}><img src="./images/pagenation/icon_prev.png" alt="" /></button></li>                                    
                                <li><button onClick={onClickPrevBtnPage} className='btn-page'><span>prev</span></button></li>  
                                </>
                                )
                            }
                            {
                                state.pageNumBtn.map((item)=>{ // 1,2,3,4,5
                                    return(
                                        <li><button onClick={(e)=>onClickPage(e, item)}>{item}</button></li>  
                                    )
                                })
                            }  
                            {
                                state.pageBtn < state.totalPageBtn && (
                                <>
                                <li><button onClick={onClickNextBtnPage} className='btn-page'><span>NEXT</span></button></li>                            
                                <li><button onClick={onClickNextPage}><img src="./images/pagenation/icon_next.png" alt="" /></button></li>    
                                <li><button onClick={onClickLastPage}><img src="./images/pagenation/icon_last.png" alt="" /></button></li>    
                                </>
                                )
                            }
                        </ul> 
                    </div>   
                </div>    


```


    
[2] 백앤드 : 
    
    - 테스트 URL
    http://gksmf519.dothome.co.kr/kurly_green/


[3] 데이터베이스
    - 관리자 자주하는 질문 테이블

    ```MYSQL        


    ```


[4] REST API 
    










